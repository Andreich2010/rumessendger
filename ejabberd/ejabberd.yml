hosts:
  - "localhost"

certfiles:
  - /home/ejabberd/certs/fullchain.pem
  - /home/ejabberd/certs/privkey.pem

listen:
  -
    port: 5222
    module: ejabberd_c2s
    starttls: true
  -
    port: 5280
    module: ejabberd_http
    request_handlers:
      "/upload": mod_http_upload

auth_method: sql
sql_type: pgsql
sql_server: postgres
sql_database: "${POSTGRES_DB}"
sql_username: "${POSTGRES_USER}"
sql_password: "${POSTGRES_PASSWORD}"

redis_server: redis

ciphers: "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"

modules:
  mod_stream_mgmt: {}
  mod_mam:
    default: always
    db_type: sql
  mod_carboncopy: {}
  mod_push:
    service_jid: push.localhost
  mod_push_keepalive: {}
  mod_http_upload:
    max_size: 10485760
    custom_headers:
      Access-Control-Allow-Origin: "*"
    s3:
      host: minio
      port: 9000
      bucket: uploads
      access_key_id: "${MINIO_ROOT_USER}"
      secret_access_key: "${MINIO_ROOT_PASSWORD}"
      scheme: http
